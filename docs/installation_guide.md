# دليل التثبيت والنشر - نظام BroMan للحسابات العقارية

**الإصدار:** 1.0  
**تاريخ الإصدار:** سبتمبر 2025  
**المؤلف:** Manus AI  

---

## جدول المحتويات

1. [نظرة عامة على عملية التثبيت](#نظرة-عامة-على-عملية-التثبيت)
2. [التحضير للتثبيت](#التحضير-للتثبيت)
3. [تثبيت النظام خطوة بخطوة](#تثبيت-النظام-خطوة-بخطوة)
4. [إعداد قاعدة البيانات](#إعداد-قاعدة-البيانات)
5. [تكوين الشبكة](#تكوين-الشبكة)
6. [اختبار التثبيت](#اختبار-التثبيت)
7. [إعداد التشغيل التلقائي](#إعداد-التشغيل-التلقائي)
8. [النسخ الاحتياطي والاستعادة](#النسخ-الاحتياطي-والاستعادة)
9. [حل مشاكل التثبيت](#حل-مشاكل-التثبيت)
10. [الصيانة الدورية](#الصيانة-الدورية)

---

## نظرة عامة على عملية التثبيت

### مقدمة

عملية تثبيت نظام BroMan مصممة لتكون بسيطة ومباشرة، حتى للمستخدمين الذين لا يملكون خبرة تقنية عميقة. هذا الدليل يوفر تعليمات مفصلة خطوة بخطوة لضمان التثبيت الناجح والتشغيل السلس للنظام. العملية تستغرق عادة بين 30 إلى 60 دقيقة، اعتماداً على سرعة الجهاز والشبكة.

النظام مبني باستخدام تقنيات حديثة ومستقرة، مما يضمن الأداء العالي والموثوقية. يستخدم Python كلغة برمجة أساسية مع إطار عمل Flask للخلفية، وقاعدة بيانات SQLite للتخزين المحلي، وBootstrap للواجهة الأمامية. هذا التصميم التقني يجعل النظام خفيف الوزن وسهل النشر والصيانة.

### متطلبات النظام

قبل البدء في عملية التثبيت، يجب التأكد من توفر المتطلبات التقنية الأساسية. للخادم الرئيسي، يُنصح بجهاز كمبيوتر بمعالج 2.0 جيجاهرتز أو أعلى، ذاكرة عشوائية 4 جيجابايت كحد أدنى (8 جيجابايت مُنصح به)، ومساحة تخزين 10 جيجابايت كحد أدنى. نظام التشغيل يمكن أن يكون Windows 10 أو أحدث، أو أي توزيعة Linux حديثة.

للأجهزة العميلة، المتطلبات أقل تعقيداً حيث أن النظام يعمل من خلال المتصفح. أي جهاز كمبيوتر أو لابتوب حديث مع متصفح ويب محدث سيكون كافياً. المتصفحات المدعومة تشمل Chrome، Firefox، Edge، وSafari في إصداراتها الحديثة.

### هيكل النظام

النظام يتكون من عدة مكونات رئيسية تعمل معاً لتوفير الوظائف المطلوبة. الخلفية (Backend) مبنية باستخدام Flask وتحتوي على منطق الأعمال وإدارة البيانات. قاعدة البيانات تستخدم SQLite وتحتوي على جميع بيانات النظام. الواجهة الأمامية (Frontend) مبنية باستخدام HTML، CSS، وJavaScript مع Bootstrap للتصميم المتجاوب.

الملفات الثابتة مثل الصور والأنماط محفوظة في مجلد منفصل، والقوالب (Templates) محفوظة في مجلد آخر. هذا التنظيم يجعل النظام سهل الفهم والصيانة. كما يحتوي النظام على ملفات الإعداد والسكريبتات المساعدة لتسهيل عمليات التثبيت والصيانة.

---

## التحضير للتثبيت

### تحضير البيئة

الخطوة الأولى في عملية التثبيت هي تحضير البيئة التشغيلية على الجهاز الذي سيستضيف النظام. هذا يتضمن التأكد من أن نظام التشغيل محدث ومثبت عليه جميع التحديثات الأمنية الضرورية. في حالة استخدام Windows، يُنصح بتشغيل Windows Update والتأكد من تثبيت جميع التحديثات المتاحة. في حالة استخدام Linux، يجب تشغيل أوامر التحديث المناسبة للتوزيعة المستخدمة.

يُنصح أيضاً بإنشاء مستخدم منفصل لتشغيل النظام، بدلاً من استخدام المستخدم الإداري الرئيسي. هذا يحسن من الأمان ويقلل من المخاطر في حالة حدوث مشاكل. المستخدم الجديد يجب أن يكون له صلاحيات كافية لتشغيل التطبيقات ولكن ليس صلاحيات إدارية كاملة.

### تحميل النظام

النظام متاح للتحميل من مستودع GitHub الخاص بالمشروع. يمكن تحميل النظام بعدة طرق، أسهلها هو تحميل ملف ZIP يحتوي على جميع الملفات المطلوبة. بدلاً من ذلك، يمكن استخدام Git لاستنساخ المستودع مباشرة، وهو الخيار المُنصح به للمستخدمين الذين يخططون لتحديث النظام بانتظام.

لتحميل النظام باستخدام Git، يجب أولاً تثبيت Git على الجهاز إذا لم يكن مثبتاً مسبقاً. بعد ذلك، يمكن تشغيل الأمر `git clone https://github.com/ukbingoopaysafe/Broman_Acc1.git` لتحميل جميع ملفات النظام إلى مجلد محلي. هذا الأمر سينشئ مجلد جديد يحتوي على جميع ملفات النظام.

### تثبيت Python

Python هو المتطلب الأساسي لتشغيل النظام، لذلك يجب التأكد من تثبيته بالإصدار الصحيح. النظام يتطلب Python 3.11 أو أحدث. يمكن تحميل Python من الموقع الرسمي python.org واختيار الإصدار المناسب لنظام التشغيل المستخدم.

أثناء تثبيت Python على Windows، من المهم جداً تفعيل خيار "Add Python to PATH" في شاشة التثبيت. هذا الخيار يسمح بتشغيل Python من أي مكان في سطر الأوامر، مما يسهل عملية التثبيت والتشغيل لاحقاً. في Linux، Python عادة مثبت مسبقاً، ولكن قد تحتاج لتثبيت pip (مدير الحزم) منفصلاً.

بعد تثبيت Python، يجب التحقق من نجاح العملية بفتح سطر الأوامر وتشغيل الأمر `python --version`. هذا الأمر يجب أن يعرض رقم إصدار Python المثبت. إذا ظهرت رسالة خطأ، فهذا يعني أن Python لم يُثبت بشكل صحيح أو أن PATH لم يُعدل بشكل صحيح.

### إعداد البيئة الافتراضية

البيئة الافتراضية (Virtual Environment) هي أداة مهمة لعزل متطلبات النظام عن باقي البرامج المثبتة على الجهاز. هذا يمنع تضارب الإصدارات ويضمن أن النظام يعمل بالمكتبات الصحيحة. إنشاء البيئة الافتراضية خطوة اختيارية ولكنها مُنصح بها بشدة، خاصة إذا كان الجهاز يستخدم لتطبيقات Python أخرى.

لإنشاء البيئة الافتراضية، يجب الانتقال إلى مجلد النظام في سطر الأوامر وتشغيل الأمر `python -m venv broman_env`. هذا الأمر سينشئ مجلد جديد يسمى `broman_env` يحتوي على نسخة منفصلة من Python وجميع المكتبات المطلوبة. اسم المجلد يمكن تغييره حسب التفضيل، ولكن يُنصح باستخدام اسم واضح ومعبر.

بعد إنشاء البيئة الافتراضية، يجب تفعيلها قبل تثبيت المتطلبات أو تشغيل النظام. في Windows، يتم التفعيل بتشغيل الأمر `broman_env\Scripts\activate`. في Linux أو Mac، يتم التفعيل بتشغيل الأمر `source broman_env/bin/activate`. عند تفعيل البيئة الافتراضية، ستلاحظ تغيير في شكل سطر الأوامر حيث سيظهر اسم البيئة في البداية.

---

## تثبيت النظام خطوة بخطوة

### الخطوة الأولى: تثبيت المتطلبات

بعد تحضير البيئة وتفعيل البيئة الافتراضية (إذا تم إنشاؤها)، الخطوة التالية هي تثبيت جميع المكتبات والحزم المطلوبة لتشغيل النظام. النظام يأتي مع ملف `requirements.txt` يحتوي على قائمة مفصلة بجميع المتطلبات مع أرقام الإصدارات المحددة. هذا يضمن أن النظام سيعمل بنفس المكتبات التي تم اختباره معها.

لتثبيت المتطلبات، يجب التأكد من أنك في مجلد النظام الرئيسي (حيث يوجد ملف requirements.txt) وتشغيل الأمر `pip install -r requirements.txt`. هذا الأمر سيقوم بتحميل وتثبيت جميع المكتبات المطلوبة تلقائياً. العملية قد تستغرق عدة دقائق اعتماداً على سرعة الإنترنت، حيث أن بعض المكتبات كبيرة الحجم.

أثناء عملية التثبيت، ستظهر رسائل في سطر الأوامر تؤكد تحميل وتثبيت كل مكتبة. هذا طبيعي ولا يدعو للقلق. في حالة ظهور رسائل خطأ، يُنصح بقراءتها بعناية لفهم سبب المشكلة. الأخطاء الشائعة تشمل مشاكل في الاتصال بالإنترنت، أو عدم توفر صلاحيات كافية للتثبيت، أو تضارب في إصدارات المكتبات.

### الخطوة الثانية: إعداد ملفات الإعداد

النظام يحتاج إلى بعض ملفات الإعداد لتحديد كيفية عمله والاتصال بقاعدة البيانات. هذه الملفات عادة تكون موجودة مع النظام، ولكن قد تحتاج لتعديل بعض القيم حسب البيئة المحلية. الملف الرئيسي للإعداد هو `config.py` والذي يحتوي على إعدادات مثل مسار قاعدة البيانات، المنفذ المستخدم، ومفتاح التشفير.

أهم إعداد يجب مراجعته هو مفتاح التشفير (SECRET_KEY) والذي يُستخدم لتأمين جلسات المستخدمين. يُنصح بشدة بتغيير هذا المفتاح من القيمة الافتراضية إلى قيمة عشوائية وفريدة. يمكن إنتاج مفتاح عشوائي باستخدام أدوات مختلفة أو حتى بكتابة نص عشوائي طويل. المهم أن يكون المفتاح معقد وصعب التخمين.

إعدادات أخرى مهمة تشمل مسار قاعدة البيانات، والذي يحدد مكان حفظ ملف قاعدة البيانات. الإعداد الافتراضي يحفظ قاعدة البيانات في نفس مجلد النظام، ولكن يمكن تغيير هذا إلى مكان آخر إذا رغبت في ذلك. كما يمكن تغيير المنفذ المستخدم من 5000 إلى منفذ آخر إذا كان هناك تضارب مع تطبيقات أخرى.

### الخطوة الثالثة: إنشاء قاعدة البيانات الأولية

بعد تثبيت المتطلبات وإعداد ملفات الإعداد، الخطوة التالية هي إنشاء قاعدة البيانات الأولية مع جميع الجداول والبيانات الافتراضية المطلوبة. النظام يأتي مع سكريبت خاص لهذا الغرض يسمى `init_database.py`. هذا السكريبت سيقوم بإنشاء جميع الجداول المطلوبة وإدراج البيانات الافتراضية مثل المستخدم الإداري وأنواع العقارات الأساسية.

لتشغيل سكريبت إنشاء قاعدة البيانات، يجب التأكد من أنك في مجلد النظام وأن البيئة الافتراضية مفعلة (إذا كنت تستخدمها)، ثم تشغيل الأمر `python init_database.py`. السكريبت سيعرض رسائل تؤكد إنشاء كل جدول وإدراج البيانات الافتراضية. العملية عادة تستغرق بضع ثوانٍ فقط.

بعد اكتمال السكريبت بنجاح، ستجد ملف قاعدة البيانات (عادة يسمى `broman.db`) في المكان المحدد في ملف الإعداد. هذا الملف يحتوي على جميع بيانات النظام وهو مهم جداً للنسخ الاحتياطي والاستعادة. يُنصح بعمل نسخة احتياطية من هذا الملف فور إنشائه وحفظها في مكان آمن.

### الخطوة الرابعة: اختبار التشغيل الأولي

بعد إعداد قاعدة البيانات، يمكن الآن اختبار تشغيل النظام للتأكد من أن كل شيء يعمل بشكل صحيح. لتشغيل النظام، يجب تشغيل الأمر `python main.py` من مجلد النظام. إذا كان كل شيء معد بشكل صحيح، ستظهر رسائل تؤكد بدء تشغيل النظام والمنفذ الذي يستمع عليه.

الرسالة النموذجية للتشغيل الناجح تكون شيء مثل "Running on http://127.0.0.1:5000" أو "Running on http://0.0.0.0:5000". هذا يعني أن النظام يعمل ويمكن الوصول إليه من خلال المتصفح. إذا ظهرت رسائل خطأ، يجب قراءتها بعناية لفهم سبب المشكلة وحلها قبل المتابعة.

لاختبار الوصول إلى النظام، افتح متصفح ويب واكتب العنوان `http://localhost:5000` أو `http://127.0.0.1:5000`. يجب أن تظهر صفحة تسجيل الدخول الخاصة بالنظام. إذا ظهرت الصفحة بشكل صحيح، فهذا يعني أن التثبيت نجح. يمكن تسجيل الدخول باستخدام البيانات الافتراضية: اسم المستخدم "admin" وكلمة المرور "admin123".

---

## إعداد قاعدة البيانات

### فهم هيكل قاعدة البيانات

قاعدة بيانات نظام BroMan مصممة بعناية لتخزين جميع المعلومات المطلوبة لإدارة الحسابات العقارية بطريقة منظمة وفعالة. القاعدة تتكون من عدة جداول مترابطة، كل جدول مخصص لنوع معين من البيانات. هذا التصميم يضمن عدم تكرار البيانات ويحسن من الأداء والموثوقية.

الجداول الرئيسية تشمل جدول المستخدمين (users) الذي يحتوي على معلومات جميع مستخدمي النظام وصلاحياتهم، جدول المعاملات (transactions) الذي يحتوي على جميع المعاملات المالية، جدول المبيعات (sales) الذي يحتوي على تفاصيل معاملات بيع العقارات، وجدول الخزنة (treasury) الذي يتتبع رصيد الشركة والمعاملات المالية.

جداول أخرى مهمة تشمل جدول أنواع العقارات (property_types) الذي يحدد أنواع العقارات المختلفة ونسب العمولات لكل نوع، وجدول الأدوار (roles) الذي يحدد الأدوار المختلفة للمستخدمين وصلاحيات كل دور. هذا التصميم المرن يسمح بإضافة أنواع عقارات جديدة أو أدوار مستخدمين جديدة دون الحاجة لتعديل هيكل القاعدة.

### البيانات الافتراضية

عند إنشاء قاعدة البيانات لأول مرة، يتم إدراج مجموعة من البيانات الافتراضية لتسهيل البدء في استخدام النظام. هذه البيانات تشمل المستخدم الإداري الافتراضي بصلاحيات كاملة، والأدوار الأساسية (مدير ومحاسب)، وأنواع العقارات الشائعة مع نسب العمولات الافتراضية.

المستخدم الإداري الافتراضي له اسم المستخدم "admin" وكلمة المرور "admin123". هذا المستخدم له صلاحيات كاملة على النظام ويمكنه إنشاء مستخدمين جدد وتعديل جميع الإعدادات. من المهم جداً تغيير كلمة مرور هذا المستخدم فور تسجيل الدخول الأول لضمان أمان النظام.

أنواع العقارات الافتراضية تشمل "شقة" بعمولة 3%، "تجاري" بعمولة 4%، "إداري" بعمولة 3.5%، و"طبي" بعمولة 4%. هذه النسب يمكن تعديلها لاحقاً حسب سياسة الشركة. كما يتم إنشاء سجل أولي في الخزنة برصيد صفر، والذي يمكن تعديله لاحقاً ليعكس الرصيد الفعلي للشركة.

### صيانة قاعدة البيانات

قاعدة بيانات SQLite المستخدمة في النظام لا تتطلب صيانة معقدة مثل قواعد البيانات الأخرى، ولكن هناك بعض الممارسات الجيدة التي يُنصح باتباعها لضمان الأداء الأمثل والموثوقية. أهم هذه الممارسات هو إجراء نسخ احتياطية منتظمة لملف قاعدة البيانات، خاصة قبل إجراء أي تحديثات أو تغييرات كبيرة على النظام.

يُنصح بإجراء نسخة احتياطية يومية لقاعدة البيانات وحفظها في مكان آمن، ويفضل أن يكون خارج الجهاز الرئيسي. يمكن أتمتة هذه العملية باستخدام سكريبتات بسيطة أو برامج النسخ الاحتياطي المتاحة. كما يُنصح بالاحتفاظ بعدة نسخ احتياطية من فترات مختلفة، بحيث يمكن الرجوع إلى نسخة أقدم في حالة حدوث مشكلة في النسخة الأحدث.

من وقت لآخر، يُنصح بتشغيل أمر VACUUM على قاعدة البيانات لتحسين الأداء وتقليل حجم الملف. هذا الأمر يعيد تنظيم البيانات ويزيل المساحات الفارغة التي قد تتكون بعد حذف البيانات. يمكن تشغيل هذا الأمر من خلال أدوات إدارة SQLite أو من خلال سكريبت مخصص.

---

